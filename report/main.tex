\include{settings}

\begin{document}

\include{titlepage}

\section*{Задание на проектирование}

{\bf Срок сдачи законченной работы: } 22.05.2017

\underline{Начальное описание предметной области:}

Структурно предприятие состоит из цехов, которые в свою очередь подразделяются на участки.

Категории изделий, выпускаемых предприятием: грузовые, легковые автомобили, автобусы, сельскохозяйственные, дорожно-строительные машины, мотоциклы и прочие изделия.
Каждая категория изделий имеет специфические, присущие только ей атрибуты.
Например, для автобусов это вместимость, для сельскохозяйственных и дорожно-строительных машин - производительность и т.д.

По каждой категории изделий может собираться несколько видов изделий (под видом изделия понимается конкретная его разновидность / марка - например, автомобиль KIA Rio).
По конкретным экземплярам каждого вида ведётся журнал, где отмечаются даты завершения различных этапов жизненного цикла изделия: изготовление (сборка) / тестирование / передача дилеру / гарантийный ремонт.

Предприятие в основном состоит из производственных цехов, но также есть несколько вспомогательных (например, ремонтный, тестировочный).

Каждая категория изделий собирается в своём производственном цехе (в одном цехе может собираться несколько категорий изделий).
Цех структурно состоит из участков, на каждом из которых выполняется один вид работ: изготавливается определённая часть изделия (например, двигатель) либо производится сборка изделия в целом.
С каждой категорией изделия ассоциируется свой набор работ; другими словами, каждая категория в процессе изготовления должна пройти определённый набор участков в цехе.

Каждой категории инженерно-технического персонала (инженеры, технологи, техники) и рабочих (сборщики, токари, слесари, сварщики и пр.) также характерны атрибуты, свойственные только для этой группы.
Рабочие объединяются в бригады, которыми руководят бригадиры.
Бригадиры выбираются из числа рабочих.
Работу цеха возглавляет начальник цеха, а работу на участке - начальник участка, в подчинении которого находится несколько мастеров.
Каждый мастер координирует работу одной или нескольких бригад (но, в отличие от бригадира, не входит в состав конкретной бригады).
Мастера, начальники участков и цехов назначаются из числа инженерно-технического персонала.
Каждый начальник может руководить только одной структурной единицей (в т.ч. начальник одной структурной единицы не может быть в то же время начальником другой).

Работу по сборке конкретной категории изделия на определенном участке выполняет одна бригада рабочих, при этом она может обслуживать несколько участков / категорий и на одном участке может работать несколько бригад.

\begin{enumerate}

    \item Сотрудники могут быть либо рабочими, либо быть из инженерно-технического персонала (ИТП).
    \item Каждой категории инженерно-технического персонала характерны атрибуты, свойственные только для этой группы.
    \item Каждой категории рабочих характерны атрибуты, свойственные только для этой группы.
    \item В инженерно-технический персонал входят инженеры, технологи и техники.
    \item Рабочие объединяются в бригады.
    \item Бригадами руководят бригадиры.
    \item Бригадиры выбираются из числа рабочих.
    \item Мастера, начальники участков и цехов назначаются из числа инженерно-технического персонала.
    \item Работу цеха возглавляет начальник цеха.
    \item Работу на участке возглавляет начальник участка, в подчинении которого находится несколько мастеров.
    \item Работу по сборке конкретной категории изделия на определенном участке выполняет одна бригада рабочих, при этом она может обслуживать несколько участков / категорий и на одном участке может работать несколько бригад.
    \item Начальник цеха может руководить только одним цехом, а начальник участка может руководить только одним участком.
    \item Мастер может руководить бригадами на нескольких участках.
    \item Бригада может работать на нескольких участках.

    \item Цехи состоят из участков

\end{enumerate}

\underline{Варианты запросов к информационной системе:}
\begin{enumerate}

    \item Перечень видов изделий по категории, собираемой указанным цехом.
    В последней строке вывести общее число собираемых видов изделий.

    \item Количество экземпляров изделий каждого вида каждой категории, собранных предприятием за определенный отрезок времени.
    В последней строке вывести общее число собранных изделий.
    Примерный вид результата:

    \begin{tabular}{|p{6cm}|p{2cm}|p{1cm}|} \hline
        Категория & Вид & Кол-во \\ \hline
        Автобусы & АКБ-12 & 8 \\ \hline
        Автобусы & АКБ-05 & 0 \\ \hline
        Автомобили & ИЖ-400 & 12 \\ \hline
        ... & ... & ... \\ \hline
        Всего собрано (12.05.2010-18.07.2010): & & 48 \\ \hline
    \end{tabular}

    \item Данные о кадровом составе (ФИО, должность) по указанным категориям инженерно-технического персонала и рабочих;
    \item Число и перечень участков предприятия и их начальников (с указанием цехов).
    \item Перечень работ, которые проходит указанный вид изделия.
    \item Состав бригад, работающих на указанном участке указанного цеха: ФИО рабочего, номер бригады, номер участка, номер цеха. Отсортировать по номеру бригады.
    \item Перечень мастеров (ФИО) указанного участка указанного цеха и номера бригад, работы которых они координируют.
    \item Информация о цехах, в которых в настоящий момент собирается больше видов изделий, чем в среднем приходится на каждый производственный цех предприятия: номер цеха, название цеха, кол-во собираемых видов изделий, среднее количество видов изделий по цехам предприятия.
    \item Состав бригад, участвующих в сборке указанной категории изделия.
    \item ФИО и должности работников цеха, в котором собирается больше всего категорий изделий.

\end{enumerate}

{\bf Перечень подлежащих разработке вопросов:}
\begin{enumerate}
    \item Проанализировать предметную область, описание которой приведено в выданном варианте задания, и создать логическую модель базы данных.
    \item Провести нормализацию разработанной модели до 5НФ.
    \item Проверить разработанную модель средствами Data Model Validator.
    \item Устранить все замечания по модели, которые выявил Data Model Validator.
    \item Создать физическую модель базы данных, предусмотрев значения по умолчанию и условия проверки вводимых пользователем значений.
    \item Провести прямое проектирование – создать объекты базы данных в Oracle.
    \item Провести обратное проектирование базы данных из Oracle. Убедиться в том, что полученные в результате модели полностью аналогичны исходным.
    \item Проверить корректность произведённого прямого проектирования и выполнение требований, приведённых в описании предметной области (наличие ключей, значений по умолчанию, условий проверки вводимых пользователем значений, связей между таблицами и др.). Проверку произвести, внеся в таблицы базы данных минимум по 5 записей.
    \item Создать 10 SQL-запросов согласно выданному варианту задания. Проверить работоспособность написанных запросов.
    \item Добавить в физическую модель представление на основе SQL-запроса, выбранного по согласованию с преподавателем.
    \item Провести прямое проектирование (перенести созданное представление). Проверить работоспособность представления.
\end{enumerate}

\newpage
\tableofcontents
\newpage

\section{Введение}
Базы данных используются повсюду.
Начиная от баз данных маленькой школы и заканчивая большими дата-центрами больших компаний.
Реляционные базы данных может быть неплохо использована в такой области деятельности, как автомобилестроительное предприятие.
Что я и покажу в данной курсовой работе.

Целью данной работы является спроектировать информационную систему автомобилестроительного предприятия по заданным бизнес-правилам.
Проверить корректность решения, используя набор программ ERwin (Data Modeler r9, AllFusion Data Model Validator r7).

Задачи, которые необходимо выполнить для достижения поставленной цели, перечислены в задании на проектирование.

\newpage

\section{Описание логической модели базы данных}

Диаграммы логической и физической моделей базы данных приведены в Приложении 1 и Приложении 2 соответственно.

\subsection{Сущности, их харрактеристики и связи}
В ходе анализа начального описания предметной области были выявлены следующие сущности:

\begin{enumerate}
    \item{Сотрудник}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        Номер\_договора & NUMBER(6, 0) & YES & NO & NO \\ \hline
        Имя\_рабочего & VARCHAR2(12) & NO & NO & NO \\ \hline
        Фамилия\_рабочего & VARCHAR2(16) & NO & NO & NO \\ \hline
        Отчество\_рабочего & VARCHAR2(16) & NO & NO & YES \\ \hline
%        todo тип сотрудника

    \end{tabular}

    \item{ИТП}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        Номер\_договора & NUMBER(6, 0) & YES & YES & NO \\ \hline
        ИД\_категории\_ИТП & NUMBER(2, 0) & NO & YES & NO \\ \hline

    \end{tabular}

    \underline{Сотрудник} может быть из \underline{инженерно-технического персонала} (1), что реализовано с помощью связи один-к-одному между соответствующими сущностями.

    \underline{Представитель инженерно-технического персонала} входит в какую-то \underline{категорию} (инженер, технолого и пр.), что реализовано с помощью связи один-ко-многим между соответствующими сущностями.

    \item{Категория ИТП}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        ИД\_категории\_ИТП & NUMBER(2, 0) & YES & NO & NO \\ \hline
        Название\_категории\_ИТП & VARCHAR2(15) & NO & NO & NO \\ \hline

    \end{tabular}

    \item{Атрибуты ИТП}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        Название\_атрибута\_ИТП & VARCHAR2(15) & YES & NO & NO \\ \hline
        ИД\_категории\_ИТП & NUMBER(2, 0) & NO & YES & NO \\ \hline

    \end{tabular}

    Каждой \underline{категории инженерно-технического персонала} характерны \underline{атрибуты}, свойственные только для этой группы (2), что и реализовано с помощью связи одни-ко-многим.

    \item{Рабочий}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        Номер\_договора & NUMBER(6, 0) & YES & YES & NO \\ \hline
        ИД\_категории\_рабочего & NUMBER(2, 0) & NO & YES & NO \\ \hline
        ИД\_бригады & NUMBER(5, 0) & NO & YES & NO \\ \hline
%        todo тип рабочего

    \end{tabular}

    \underline{Сотрудник} может быть \underline{рабочим} (1), что реализовано с помощью связи один-к-одному между соответствующими сущностями.

    \underline{Рабочий} входит в какую-то \underline{категорию} (сборщики, токари и пр.), что реализовано с помощью связи один-ко-многим между соответствующими сущностями.

    \underline{Рабочие} объединяются в бригады (5), что реализовано с помощью связи один-ко-многим.

    \item{Категория рабочего}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        ИД\_категории\_рабочего & NUMBER(2, 0) & YES & NO & NO \\ \hline
        Название\_категории\_рабочего & VARCHAR2(15) & NO & NO & NO \\ \hline

    \end{tabular}

    \item{Атрибуты рабочего}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        Название\_атрибута\_ИТП & VARCHAR2(15) & YES & NO & NO \\ \hline
        ИД\_категории\_ИТП & NUMBER(2, 0) & NO & YES & NO \\ \hline

    \end{tabular}

    Каждой \underline{категории рабочих} характерны \underline{атрибуты}, свойственные только для этой группы (3), что и реализовано с помощью связи одни-ко-многим между соответсвующими сущностями.

    \item{Бригада}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        ИД\_бригады & NUMBER(5, 0) & YES & NO & NO \\ \hline
        Название\_бригады & VARCHAR2(12) & NO & NO & NO \\ \hline
        Номер\_договора & NUMBER(6, 0) & NO & YES & NO \\ \hline

    \end{tabular}

    Бригадами руководят бригадиры (6).
    Бригадиры выбираются из числа рабочих (7).
    Номер\_договора - бригадир.
    Реализуем связь один-ко-многим между соответствующими сущностями.

    \item{Мастер}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        Номер\_договора & NUMBER(6, 0) & YES & YES & NO \\ \hline

    \end{tabular}
    {\bf Примечание:} Договор\_нач\_уч - номер договора начальника. Договор\_мастера - номер договора мастера.

    \underline{Мастера} назначаются из \underline{инженерно-технического персонала} (8), что и реализовано связью один-к-одному.

    \item{Начальник участка}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        Номер\_договора & NUMBER(6, 0) & YES & YES & NO \\ \hline

    \end{tabular}

    \underline{Начальники участка} назначаются из \underline{инженерно-технического персонала} (8), что и реализовано связью один-к-одному.

    \item{Начальник цеха}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        Номер\_договора & NUMBER(6, 0) & YES & YES & NO \\ \hline

    \end{tabular}

    \underline{Начальники цеха} назначаются из \underline{инженерно-технического персонала} (8), что и реализовано связью один-к-одному.

    \item Мастер\_начальник

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        Договор\_мастера & NUMBER(6, 0) & YES & YES & NO \\ \hline
        Договор\_нач\_уч & NUMBER(6, 0) & YES & YES & NO \\ \hline

    \end{tabular}

    В подчинении \underline{начальника участка} находятся несколько \underline{мастеров} (10) и у мастера может быть несколько начальников (13).
    Что реализовывается связью один-ко-многим между соответствующими сущностями.

    \item Мастер\_бригада

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        ИД\_бригады & NUMBER(5, 0) & YES & YES & NO \\ \hline
        Договор\_мастера & NUMBER(6, 0) & YES & YES & NO \\ \hline

    \end{tabular}

    Одна бригада может обслуживать несколько участков (11), а следовательно \underline{бригадой} могут руководить несколько \underline{мастеров}.
    Данная ассоциативная таблица разрешает связь многие-ко-многим.

    \item{Участок}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        Номер\_участка & NUMBER(2, 0) & YES & NO & NO \\ \hline
        Название\_участка & VARCHAR2(14) & NO & NO & NO \\ \hline
        Номер\_цеха & NUMBER(3, 0) & NO & YES & NO \\ \hline
        Тип\_участка & VARCHAR2(9) & NO & NO & NO \\ \hline
        Номер\_договора & NUMBER(6, 0) & NO & YES & NO \\ \hline

    \end{tabular}

    Constraint for Тип\_участка: "Изготовка" и "Сборка"

    \item{Цех}

    \begin{tabular}{|p{4cm}|p{3cm}|p{1cm}|p{1cm}|p{2cm}|} \hline

        {\bf COLUMN\_NAME} & {\bf DATA\_TYPE} & {\bf PK} & {\bf FK} & {\bf NULLABLE} \\ \hline
        Номер\_цеха & NUMBER(3, 0) & YES & NO & NO \\ \hline
        Тип\_цеха & VARCHAR2(16) & NO & NO & NO \\ \hline
        Название\_цеха & VARCHAR2(15) & NO & NO & NO \\ \hline
        Номер\_договора & NUMBER(6, 0) & NO & YES & NO \\ \hline

    \end{tabular}

    Constraint for Тип\_цеха: "Производственный" и "Вспомогательный"

    \item{Журнал}

    \item{Вид изделия}

    \item{Категория изделия}

    \item{Атрибуты изделия}

    \item{Вид работы}

\end{enumerate}

\section {Нормализация}
Нормализацией называется формальная процедура, в ходе которой создается оптимизированная структура базы данных, позволяющая избегать различные виды аномалий.

\begin{itemize}
    \item Первая нормальная форма (1 НФ)
    \item Вторая нормальная форма (2 НФ)
    \item Третья нормальная форма (3 НФ)
    \item Нормальная форма Бойса-Кодда (НФБК)
    \item Четвертая нормальная форма (4 НФ)
    \item Пятая нормальная форма (5 НФ)
\end{itemize}

{\bf Проверим на первую нормальную форму:}

Отношение находится в первой нормальной форме, тогда, когда на пересечении каждой строки и каждого столбца содержится ровно одно значение.
Во всех приведенных сущностях соблюдается атомарность данных.
Следовательно, все отношения в модели подчиняются 1 НФ.

{\bf Проверим на 2 нормальную форму:}

Отношение находится во второй нормальной форме тогда, когда отношение находится в 1НФ, и нет неключевых атрибутов, зависящих от части сложного ключа.
Проверять нужно только сущности, содержащие несколько ключевых атрибутов: ...

{\bf Проверим на 3 нормальную форму:}

Отношение находится в третьей нормальной форме тогда, когда отношение находится в 2НФ, и все неключевые атрибуты взаимно независимы.
Проверять нужно только сущности, содержащие несколько неключевых атрибутов: ...

{\bf Проверка на нормальную форму Бойса-Кодда:}

Отношение находится в нормальной форме Бойса-Кодда тогда, когда отношение находится в 3 НФ, и любая выполняемая для этого отношения нетривиальная и минимальная функциональная зависимость имеет в качестве детерминанта некоторый возможный ключ данного отношения.
Проверять нужно только сущности, содержащие несколько пересекающихся потенциальных ключей: ...

{\bf Проверка на 4 нормальную форму:}

Отношение находится в четвертой нормальной форме тогда, когда отношение находится в НФБК и не содержит нетривиальных многозначных зависимостей.
Проверять нужно только сущности, имеющие в составе первичного ключа три атрибута и более: ...

{\bf Проверка на 5 нормальную форму:}

Отношение находится в пятой нормальной форме тогда, когда отношение находится в 4 НФ, и каждая нетривиальная зависимость соединения в нём определяется потенциальным ключом (ключами) этого отношения.
Проверять нужно только сущности, имеющие в составе первичного ключа три атрибута и более: ...

\section {ERwin Data Model Validator}

ERwin Data Model Validator выдает ошибку Infinite Loop.
Это связано с тем, что отношения Бригада и Рабочий имеют две связи один ко многим.
Так как по условию нам дано следующее: рабочие объединяются в бригады, которыми руководят бригадиры, а бригадиры выбираются из числа рабочих.
Следовательно, выбранные связи обоснованы.

На мое удивление Validator показывает ошибку Infinite Loop, а не Cross Linked RelationShips.
Однако я все равно обосную, почему эти две ошибки не окажут никакого воздействия не схему.
Cross Linked RelationShips в данном случае не уместен, так как связи имеют Cardinality: Zero, One or More.
А следовательно, даже при пустой таблице мы можем вставить данные, указав Null.
Infinite Loop же обошел использованием Set Null on delete.
Поэтому неприятной ситуации с Delete Cascade можно избежать.

\section {Реализация запросов к базе данных}

\end{document}